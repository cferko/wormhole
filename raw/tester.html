<html>
<script>
function sH(k,v) {
    //console.log(k,v);
    document.getElementById(k).innerHTML = v;
}
//var testData = JSON.stringify(["exsp_test_one",{"x":3,"y":4}]);
//var testData = JSON.stringify(["exsp_test_exception",{}]);
var testData = "select * from symb.prefixes;";
console.log(testData);
function foobar() {
    var request = new XMLHttpRequest();
    function onStateChange() {
        console.log("state",request.readyState);
        if (request.readyState != 4) return;
        sH("statusDiv",request.status);
        sH("pre1",request.responseText);
    }
    request.onreadystatechange = onStateChange;
    request.open("POST",window.location.pathname,true);
    console.log("opened");
    request.send(testData);
    console.log("done");
}
</script>
<form method="POST">
<input type="text" name="query" value="select * from symb.prefixes;" size="40"/>
<br />
<input type="submit" value="via form post" />
</form>

<!--
<form method="POST">
<input type="text" name="what" value='["exsp_test_many",{}]' size="40"/>
<br />
<input type="submit" value="via form post" />
</form>

<form method="POST">
<input type="text" name="what" value='["exsp_test_exception",{}]' size="40"/>
<br />
<input type="submit" value="via form post" />
</form>
-->

<br /><br />
<button onclick="foobar()" >or via ajax</button>
<div id="statusDiv"></div>
<pre id="pre1">
</pre>
</html>
